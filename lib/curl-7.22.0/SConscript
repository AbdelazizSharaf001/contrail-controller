# -*- mode: python; -*-

# path to the sources
vpath = '#/third_party/curl-7.22.0'

env = DefaultEnvironment().Clone()

#env.Append(CPPPATH = ['#/third_party/curl-7.22.0/src/',
#                      '#/third_party/curl-7.22.0/lib/',
#                      '#/third_party/curl-7.22.0/include/'])

VariantDir(vpath + '/src', '#/' + Dir('.').path + '/src')

# use 'configure' first to set things up
cfg_opts = '--prefix=' + str(Dir('#/build')) + ' ' + \
              '--disable-dependency-tracking ' + ' ' + '--enable-debug'

cmd = ('(cd ' + Dir('.').abspath + '; ' + str(Dir(vpath)) +
           '/configure' + ' ' + cfg_opts + '; make clean; make; make install)')

products = ['#/build/lib/libcurl.a', '#/build/include/curl/curl.h']

curl_cfg = env.Command('config.status', str(Dir(vpath)), cmd)

env.SideEffect(products, curl_cfg)


